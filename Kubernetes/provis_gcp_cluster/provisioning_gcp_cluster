gcloud auth login
gcloud config set project <YOUR_PROJECT_ID>
gcloud config set compute/zone europe-west1-b

gcloud services enable compute.googleapis.com

gcloud compute networks create k8s-net --subnet-mode=custom
gcloud compute networks subnets create k8s-subnet \
  --network=k8s-net --range=10.240.0.0/24

gcloud compute firewall-rules create k8s-allow-internal \
  --network=k8s-net --allow tcp,udp,icmp \
  --source-ranges=10.240.0.0/24

gcloud compute firewall-rules create k8s-allow-external \
  --network=k8s-net --allow tcp:22,tcp:6443,icmp \
  --source-ranges=0.0.0.0/0


gcloud compute instances create k8s-master \
  --zone=europe-west4-a \
  --machine-type=e2-standard-2 \
  --subnet=k8s-subnet \
  --network=k8s-net \
  --image-family=ubuntu-2204-lts \
  --image-project=ubuntu-os-cloud \
  --boot-disk-size=30GB \
  --boot-disk-type=pd-standard \
  --tags=k8s

gcloud compute instances create k8s-worker-1 k8s-worker-2 \
  --zone=europe-west4-a \
  --machine-type=e2-medium \
  --subnet=k8s-subnet \
  --network=k8s-net \
  --image-family=ubuntu-2204-lts \
  --image-project=ubuntu-os-cloud \
  --boot-disk-size=20GB \
  --boot-disk-type=pd-standard \
  --tags=k8s